## `nbdev`

### Setup

The steps below outline how I set up this demo.

#### Conda environment

To get started, I first create a `conda` environment with everything I'll need:
```sh
mamba create -yn demo python quarto jupyterlab jupyterlab_vim jupytext nbdev black r-irkernel
mamba activate demo
```

Prior to running the command above, I installed the `mambaforge` Python distribution via homebrew and set up my shell to use the `mamba` command:
```sh
brew install mambaforge
mamba init zsh
```

Actually, that was a lie. My setup is much more automated than that :)

I have a setup script that doubles as the [README.md](https://github.com/mskar/setup#this-repo-contains-my-setup-files-for-mac-local-and-linux-remote) of my [setup repository](https://github.com/mskar/setup).

The setup script also installs the carbonyl https://github.com

From nbdev, I only use the git and Jupyter hooks.

### Running `nbdev_install_hooks` results in 4 changes:

1. Add Python code to `~/.jupyter/jupyter_notebook_config.py` and `~/.jupyter/jupyter_server_config.py`:

```python
def nbdev_clean_jupyter(**kwargs):
    try: from nbdev.clean import clean_jupyter
    except ModuleNotFoundError: return
    clean_jupyter(**kwargs)

c.ContentsManager.pre_save_hook = nbdev_clean_jupyter
```

2. Add a `.gitconfig` file to the current repository:

```sh
# Generated by nbdev_install_hooks
#
# If you need to disable this instrumentation do:
#   git config --local --unset include.path
#
# To restore:
#   git config --local include.path ../.gitconfig
#
[merge "nbdev-merge"]
	name = resolve conflicts with nbdev_fix
	driver = nbdev_merge %O %A %B %P
```

3. Replace `.git/hooks/post-merge.sample` with `.git/hooks/post-merge` in the current repository:

```sh
nbdev_trust
```

4. Add a `.gitattributes` file to the current repository:

```sh
*.ipynb merge=nbdev-merge
```

### pre-commit

The `nbdev` docs discuss [pre-commit](https://nbdev.fast.ai/tutorials/pre_commit.html) and provide a `.pre-commit-config.yaml` file:

```
repos:
- repo: https://github.com/fastai/nbdev
  rev: 2.2.10
  hooks:
  - id: nbdev_clean
  - id: nbdev_export
```

I decided to add my own pre-commit hook to the mix:

```sh
for q in *.qmd; do; quarto convert $q; quarto render $q; done;
```
